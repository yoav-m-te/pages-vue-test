(function(t){function e(e){for(var a,n,i=e[0],c=e[1],l=e[2],u=0,p=[];u<i.length;u++)n=i[u],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&p.push(o[n][0]),o[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);h&&h(e);while(p.length)p.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,i=1;i<s.length;i++){var c=s[i];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=n(n.s=s[0]))}return t}var a={},o={app:0},r=[];function n(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=a,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(s,a,function(e){return t[e]}.bind(null,a));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var h=c;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"19cc":function(t,e,s){},"2d2f":function(t,e,s){"use strict";s("746d")},"40c4":function(t,e,s){"use strict";s("19cc")},"56d7":function(t,e,s){"use strict";s.r(e);var a=s("2b0e"),o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("img",{staticClass:"logo",attrs:{alt:"Tech Elevator",src:s("cf05")}}),e("map-demo")],1)},r=[],n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"container"},on:{click:t.handleMapClick}},[e("h1",[t._v("My Map Demo")]),e("div",{staticClass:"search"},[e("type-ahead"),e("div",{staticClass:"search-btns"},[e("button",{staticClass:"searchBtn",on:{click:t.doSearch}},[t._v("Search")]),e("button",{staticClass:"searchBtn",on:{click:t.doGo}},[t._v("Go")]),e("button",{staticClass:"searchBtn",on:{click:t.centerMap}},[t._v("Origin")]),e("button",{staticClass:"searchBtn",on:{click:t.clear}},[t._v("Clear")])])],1),e("div",{staticClass:"map-section"},[e("div",{ref:"theMap",attrs:{id:"mapContainer"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.handleContextMenu(e)}}},[e("context-menu",{ref:"menu",staticClass:"context-menu",attrs:{display:t.showContextMenu,choices:t.choices}})],1)])])},i=[],c=(s("6cc5"),s("e11e")),l=s.n(c),h=s("cee4"),u={addressSearch(t,e){return h["a"].get(`https://nominatim.openstreetmap.org/?addressdetails=1&q=${t}&format=json&limit=${e}`)},reverseLookup(t){return h["a"].get(`https://nominatim.openstreetmap.org/reverse?lat=${t.lat}&lon=${t.lng}&format=json`)},mapBoxFindAddress(t){return h["a"].get(`https://api.mapbox.com/geocoding/v5/mapbox.places/${t}.json?&access_token=pk.eyJ1IjoieW9hdi1tLXRlIiwiYSI6ImNsMGN5bGoxbDAyb2wza2xjaW81MWszcXoifQ.go165gRzkDJg4-GaoXCm3Q`)},mapBoxSearchBBox(t,e){return h["a"].get(`https://api.mapbox.com/geocoding/v5/mapbox.places/${t}.json?bbox=${e}&access_token=pk.eyJ1IjoieW9hdi1tLXRlIiwiYSI6ImNsMGN5bGoxbDAyb2wza2xjaW81MWszcXoifQ.go165gRzkDJg4-GaoXCm3Q`)},mapBoxSearch(t,e){return h["a"].get(`https://api.mapbox.com/geocoding/v5/mapbox.places/${t}.json?proximity=${e}&access_token=pk.eyJ1IjoieW9hdi1tLXRlIiwiYSI6ImNsMGN5bGoxbDAyb2wza2xjaW81MWszcXoifQ.go165gRzkDJg4-GaoXCm3Q`)},getBboxString(t){const e=t._northEast,s=t._southWest,a=`${s.lng},${s.lat},${e.lng},${e.lat}`;return a}},p=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],ref:"context",staticClass:"context-menu",style:t.style,attrs:{tabindex:"0"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.close()}}},[t._t("default",(function(){return t._l(t.choices,(function(s,a){return e("div",{key:a,staticClass:"choice",on:{click:function(e){return t.handleChoice(s)}}},[t._v(" "+t._s(s)+" ")])}))}))],2)},m=[],d={name:"CmpContextMenu",props:{display:Boolean},data(){return{left:0,top:0,show:!1,choices:[]}},computed:{style(){return{top:this.top+"px",left:this.left+"px"}}},methods:{close(){this.show=!1,this.left=0,this.top=0,this.$store.commit("UPDATE_CONTEXT_MENU_VISIBLE",!1)},open(t,e,s){this.left=e.x,this.top=e.y,this.choices=s,a["a"].nextTick(()=>this.$el.focus()),this.show=!0,this.$store.commit("UPDATE_CONTEXT_MENU_CHOICE",""),this.$store.commit("UPDATE_CONTEXT_MENU_VISIBLE",!0)},handleChoice(t){this.$store.commit("UPDATE_CONTEXT_MENU_CHOICE",t)}}},f=d,g=(s("2d2f"),s("2877")),_=Object(g["a"])(f,p,m,!1,null,null,null),v=_.exports,x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"typeaheadsearch"},[e("div",{staticClass:"search-container"},[e("label",{attrs:{for:"search-no-fill"}},[t._v("Search: ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchString,expression:"searchString"}],staticClass:"searchField",attrs:{type:"text",id:"search-no-fill",autocomplete:"do-not-autofill"},domProps:{value:t.searchString},on:{keyup:t.handleKeyUp,input:function(e){e.target.composing||(t.searchString=e.target.value)}}})]),t._e(),e("div",{staticClass:"results-container"},[e("type-ahead-results",{directives:[{name:"show",rawName:"v-show",value:t.results.length>0,expression:"results.length > 0"}],style:t.resultsStyle})],1)])},E=[],b=(s("14d9"),function(){var t=this,e=t._self._c;return t.results.length>0?e("div",{staticClass:"results",style:t.style},t._l(t.results,(function(s,a){return e("div",{key:a,staticClass:"result-item",attrs:{id:"cell-"+a},on:{click:function(e){return t.handleClick(s)},mouseover:function(e){return t.setMouseOverCell(e)}}},[e("span",{staticClass:"cell",class:{highlight:"cell-"+a==t.mouseOverCell}},[t._v(t._s(s.place_name))])])})),0):t._e()}),M=[],C={name:"type-ahead-results",data(){return{left:10,top:10,show:!1,mouseOverCell:""}},computed:{style(){return{}},results(){return this.$store.state.typeAheadResults}},methods:{handleFieldFocus(t){t.prevent.stop},handleClick(t){this.$store.commit("ADD_MARKER_TO_MAP",t),this.clear()},clear(){this.$store.commit("UPDATE_SEARCH_STRING",""),this.$store.commit("UPDATE_TYPE_AHEAD_RESULTS",[])},setMouseOverCell(t){t.stop;const e=t.target.id,s=t.target.getBoundingClientRect();console.log(s),this.mouseOverCell=e}}},y=C,k=(s("5cb6"),Object(g["a"])(y,b,M,!1,null,null,null)),S=k.exports,A={name:"type-ahead-search",components:{TypeAheadResults:S},data(){return{searchString:"",waiting:!1}},computed:{searchText(){return this.$store.state.searchString},bbox(){return this.$store.state.mapBounds},results(){return this.$store.state.typeAheadResults},resultsVisible(){return""!=this.searchText&&this.results.length>0},resultsStyle(){return{visibility:this.resultsVisible?"visible":"hidden",opacity:this.resultsVisible?1:0,position:"absolute",transition:"all 0.5s ease","margin-top":0,left:"100px",display:this.resultsVisible?"block":"none","flex-direction":"column","align-content":"stretch","white-space":"nowrap",overflow:"auto"}}},methods:{handleKeyUp(){this.$store.commit("UPDATE_SEARCH_STRING",this.searchString),this.waiting||(this.waiting=!0,u.mapBoxSearchBBox(this.searchText,u.getBboxString(this.bbox)).then(t=>{let e=[];if(t&&t.data&&t.data.features){const s=t.data.features;s.forEach(t=>{e.push(t)}),this.updateTypeAheadResults(e),this.waiting=!1}}))},updateTypeAheadResults(t){this.$store.commit("UPDATE_TYPE_AHEAD_RESULTS",t)}},watch:{searchText(t,e){t!=e&&""==t&&(this.searchString="")}}},T=A,w=(s("40c4"),Object(g["a"])(T,x,E,!1,null,null,null)),$=w.exports,R={name:"map-demo",components:{ContextMenu:v,TypeAhead:$},data(){return{searchString:"",showContextMenu:!1,map:{},mapCenter:[39.9552836,-75.182144],startCity:"Philadelphia",startSearch:"30 S 17th Street",zoom:13,markerIcon:l.a.icon({iconUrl:s("c7a3"),iconSize:[30,30]}),choices:["Add Pin","Cancel"],markerChoices:["Remove Pin","Cancel"],savedEvent:"",savedMarkerEvent:"",goPoint:"",proximity:""}},mounted(){this.setupMapBoxLeafletMap(),this.initMap()},computed:{choice(){return this.$store.state.contextSelection},newMarker(){return this.$store.state.newMarker},showTypeAheadResults(){return this.$store.state.typeAheadResults.length>0},searchText(){return this.$store.state.searchString}},methods:{setupMapBoxLeafletMap(){const t="pk.eyJ1IjoieW9hdi1tLXRlIiwiYSI6ImNsMGN5bGoxbDAyb2wza2xjaW81MWszcXoifQ.go165gRzkDJg4-GaoXCm3Q";let e=l.a.tileLayer("https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token="+t,{attribution:'© <a href="https://www.mapbox.com/feedback/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',tileSize:512,zoomOffset:-1});this.map=l.a.map("mapContainer",{center:this.mapCenter,zoom:this.zoom}).addLayer(e);const s=this.handleDragEnd;this.map.on("moveend",(function(){s()}))},initMap(){u.mapBoxFindAddress(this.startCity).then(t=>{if(t.data.features.length>0){const e=t.data.features.find(t=>"place"==t.place_type);if(e){const t=e.bbox,s=`${t[0]},${t[1]},${t[2]},${t[3]}`;u.mapBoxSearchBBox(this.startSearch,s).then(t=>{if(t.data.features.length>0){const e=t.data.features[0],s=e.center;this.mapCenter=[s[1],s[0]],this.proximity=[s[0],s[1]],this.map.setView(this.mapCenter,this.zoom);const a={lng:s[0],lat:s[1]};this.createMarker(a,e.place_name)}})}this.updateMapBounds()}})},updateMapBounds(){this.$store.commit("UPDATE_MAP_BOUNDS",this.map.getBounds())},doSearch(){this.mapBoxSearchBbox(this.searchText),this.$store.commit("UPDATE_SEARCH_STRING","")},doGo(){this.go(this.searchText,20),this.$store.commit("UPDATE_SEARCH_STRING","")},go(t){u.mapBoxFindAddress(t).then(t=>{const e=t.data.features;if(e.length>1){const t=e[0],s={lng:t.center[0],lat:t.center[1]};this.createMarker(s,t.place_name),this.map.setView([s.lat,s.lng],this.zoom),this.proximity=[s.lng,s.lat],this.updateMapBounds()}})},addMarker(t){if(t.length>0)for(let e=0;e<t.length;e++){const s=t[e];if("pedestrian"!=s.type){const t={lng:s.lon,lat:s.lat};this.createMarker(t,s.display_name)}}},createMarker(t,e){if(!this.markerExists(t)){const s=l.a.marker({lon:t.lng,lat:t.lat},{icon:this.markerIcon}).bindPopup(e).on("contextmenu",t=>this.handleMarkerClick(t)).on("mouseover",(function(){this.openPopup()})).on("mouseout",(function(){this.closePopup()})).addTo(this.map);this.$store.commit("ADD_MARKER",s)}},getCoordsFromClick(t){return this.map.mouseEventToLatLng(t)},createMarkerFromCoords(t){u.reverseLookup(t).then(e=>{const s=e.data.address,a=this.getInfoFromReverseLookupData(s);this.createMarker(t,a)})},getInfoFromReverseLookupData(t){const e=`${t.house_number?t.house_number:""} ${t.road}, ${t.city} ${t.state} ${t.postcode}, ${t.country}`;return e},centerMap(){this.map.setView(this.mapCenter,this.zoom)},handleContextMenu(t){t.target==t.currentTarget&&(this.savedEvent=t,this.$refs.menu.open(t,this.map.mouseEventToContainerPoint(t),this.choices))},handleMapClick(){this.$refs.menu.close(),this.savedEvent={},this.$store.commit("UPDATE_TYPE_AHEAD_RESULTS",[])},handleMarkerClick(t){this.savedMarkerEvent=t,this.$refs.menu.open(t,this.map.mouseEventToContainerPoint(t.originalEvent),this.markerChoices)},removeMarker(){const t=this.savedMarkerEvent.target._leaflet_id,e=this.$store.state.markers.find(e=>e._leaflet_id==t);e.closePopup().unbindPopup(),e.remove(),this.$store.commit("REMOVE_MARKER",t),this.savedMarkerEvent=""},clear(){this.$store.state.markers.forEach(t=>{t.closePopup().unbindPopup(),t.remove()}),this.$store.commit("REMOVE_ALL_MARKERS"),this.centerMap(),this.search(this.startSearch,5)},markerExists(t){let e=!1;return this.$store.state.markers.forEach(s=>{const a=s._latlng;t.lng==a.lng&&t.lat==a.lat&&(e=!0)}),e},mapBoxSearch(t){const e=`${this.proximity[0]},${this.proximity[1]}`;u.mapBoxSearch(t,e).then(t=>{const e=t.data.features;e.forEach(t=>{const e={lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1]};this.createMarker(e,t.place_name)})})},mapBoxSearchBbox(t){const e=this.map.getBounds(),s=u.getBboxString(e);u.mapBoxSearchBBox(t,s).then(t=>{const e=t.data.features;e.forEach(t=>{const e={lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1]};this.createMarker(e,t.place_name)})})},handleDragEnd(){const t=this.map.getCenter();this.proximity=[t.lng,t.lat],this.updateMapBounds()}},watch:{choice(t,e){if(t!=e)if("Add Pin"===t){if(""!=this.savedEvent){const t=this.getCoordsFromClick(this.savedEvent);this.createMarkerFromCoords(t)}}else"Remove Pin"===t&&""!=this.savedMarkerEvent&&this.removeMarker()},newMarker(t,e){if(t&&t!=e&&""!=t){const e={lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1]};this.createMarker(e,t.place_name)}}}},P=R,D=(s("8f22"),Object(g["a"])(P,n,i,!1,null,"64f149fe",null)),B=D.exports,O={name:"App",components:{MapDemo:B}},I=O,U=(s("ebfe"),Object(g["a"])(I,o,r,!1,null,null,null)),N=U.exports,j=s("2f62");a["a"].use(j["a"]);var L=new j["a"].Store({state:{savedInfo:{},markers:[],newMarker:"",contextMenuVisible:!1,contextSelection:"",contextChoices:[],mapBounds:{},searchString:"",typeAheadResults:[]},mutations:{SAVE_INFO(t,e){t.savedInfo=e},ADD_MARKER(t,e){t.markers.push(e)},REMOVE_MARKER(t,e){t.markers=t.markers.filter(t=>t._leaflet_id!=e)},REMOVE_ALL_MARKERS(t){t.markers=[]},UPDATE_CONTEXT_MENU_VISIBLE(t,e){t.contextMenuVisible=e},UPDATE_CONTEXT_MENU_CHOICE(t,e){t.contextSelection=e},UPDATE_CONTEXT_CHOICES(t,e){this.contextChoices=e},UPDATE_MAP_BOUNDS(t,e){t.mapBounds=e},UPDATE_SEARCH_STRING(t,e){t.searchString=e},UPDATE_TYPE_AHEAD_RESULTS(t,e){t.typeAheadResults=e},ADD_MARKER_TO_MAP(t,e){t.newMarker=e}},actions:{},modules:{}});a["a"].config.productionTip=!1,new a["a"]({store:L,render:t=>t(N)}).$mount("#app")},"5cb6":function(t,e,s){"use strict";s("e64e")},"746d":function(t,e,s){},"8f22":function(t,e,s){"use strict";s("cb26")},c7a3:function(t,e,s){t.exports=s.p+"img/marker-blue.ed1068e9.png"},cb26:function(t,e,s){},cf05:function(t,e,s){t.exports=s.p+"img/logo.c7ad0b19.png"},e64e:function(t,e,s){},ebfe:function(t,e,s){"use strict";s("f674")},f674:function(t,e,s){}});
//# sourceMappingURL=app.9a922150.js.map